<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raymarcher Visualiser</title>
    <!-- donut -->
    <link rel="icon" type="image/x-icon" href="/cpu-raymarcher/favicon.ico">
  <script type="module" crossorigin src="/cpu-raymarcher/assets/index-BJDBX-43.js"></script>
  <link rel="stylesheet" crossorigin href="/cpu-raymarcher/assets/index-pCBv0YPz.css">
</head>
<body>
    <!-- Fixed top bar with title + theme toggle -->
    <div class="top-bar">
        <h1>Raymarcher Visualiser</h1>
        <div id="theme">
            <button id="theme-switch">
                <!-- Light mode icon -->
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    height="24px" 
                    viewBox="0 -960 960 960" 
                    width="24px" 
                    fill="#e3e3e3"
                >
                    <path 
                        d="
                            M480-280q-83 0-141.5-58.5T280-480q0-83 
                            58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5
                            141.5T480-280ZM200-440H40v-80h160v80Zm720 
                            0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 
                            720v-160h80v160h-80ZM256-650l-101-97 57-59 96 
                            100-52 56Zm492 496-97-101 53-55 101 97-57 
                            59Zm-98-550 97-101 59 57-100 
                            96-56-52ZM154-212l101-97 55 53-97 101-59-57Z
                        "
                    />
                </svg>
                <!-- Dark mode icon -->
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24px"
                    height="24px"
                    viewBox="0 -960 960 960"
                    fill="#e3e3e3"
                >
                    <path
                        d="
                            M480-120 q-150 0-255-105T120-480 
                            q0-150 105-255t255-105 q14 0 27.5 1t26.5 3
                            q-41 29-65.5 75.5T444-660 q0 90 63 153t153 63
                            q55 0 101-24.5t75-65.5 q2 13 3 26.5t1 27.5
                            q0 150-105 255T480-120Z
                        "
                    />
                </svg>
            </button>
        </div>
    </div>

    <div class="page-wrapper">
        <div id="views">
            <div id="page-selection">
                <button id="playground-btn" data-target="playground-view" class="selection-btn">Playground</button>
                <button id="analytics-btn" data-target="analytics-view" class="selection-btn">Analytics</button>
            </div>
            <!-- PLAYGROUND VIEW -->
            <div id="playground-view" class="view active-view">
                <!-- View selection -->
                <div id="app">
                    <div id="editor-container">
                        <div>
                            <label for="algorithm">Select algorithm: </label>
                            <select name="selectedAlgo" id="algorithm">
                                <option value="sphere-tracing">Sphere Tracing</option>
                                <option value="fixed-step">Fixed Step</option>
                                <option value="adaptive-step">Adaptive Step</option>
                                <option value="adaptive-step-v2">Adaptive Step V2</option>
                            </select>
                        </div>

                        <div id="toggles">
                            <label for="octree-toggle">
                                <input type="checkbox" id="octree-toggle" name="octree">
                                Use Octree Acceleration
                            </label>
                            <label for="bvh-toggle">
                                <input type="checkbox" id="bvh-toggle" name="bvh">
                                Use BVH Acceleration
                            </label>
                        </div>

                        <div>
                            <!-- No other way to do this without making it wonky! -->
                            <label for="scene-select">Select scene:</label>
                            <div class="field-hint">Scenes marked [A] are animated.</div>
                            <select name="selectedScene" id="scene-select">
                                <!-- Will be filled automatically in main.ts -->
                            </select>
                        </div>

                        <div>
                            <label for="shading-model">Shading model: </label>
                            <select name="selectedModel" id="shading-models">
                                <option value="normal">Normal</option>
                                <option value="phong">Phong</option>
                                <option value="sdf-heatmap">SDF Heatmap</option>
                                <option value="iteration-heatmap">Iteration Heatmap</option>
                            </select>
                        </div>

                        <div id="overshoot-slider-container" style="display: none;">
                            <label for="overshoot-slider">Overshoot Factor: <span id="overshoot-value">1.2</span></label>
                            <input type="range" id="overshoot-slider" min="1.0" max="2.0" step="0.05" value="1.2">
                        </div>

                        <div id="stepsize-slider-container" style="display: none;">
                            <label for="stepsize-slider">Step Size: <span id="stepsize-value">0.1</span></label>
                            <input type="range" id="stepsize-slider" min="0.01" max="0.5" step="0.01" value="0.1">
                        </div>
                    </div>

                    <div id="canvas-container">
                        <canvas id="shader-canvas" width="128" height="128"></canvas>
                        <!-- Resolution is currently fixed but can be user-selectable later. -->
                    </div>

                    <!-- For mobile users only -->
                    <div id="dpad">
                        <p>Rotate camera</p>
                        <button id="left">←</button>
                        <button id="up">↑</button>
                        <button id="down">↓</button>
                        <button id="right">→</button>
                    </div>

                    <!-- Performance metrics & controls guide -->
                    <div id="right-side-panel">
                        <p><b>Performance Metrics</b></p>
                        <div id="diagnostics">
                            <p id="fps">Frame length: 0</p>
                            <p id="average-sdf-calls">Average SDF calls: 0</p>
                            <p id="max-sdf-calls">Max SDF calls: 0</p>
                            <p id="min-sdf-calls">Min SDF calls: 0</p>
                            <p id="average-iterations">Average iterations: 0</p>
                            <div id="controls">
                                <strong>Controls:</strong><br>
                                Arrow keys: Camera<br>
                                -/+: Scale display<br>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ANALYTICS VIEW -->
            <div id="analytics-view" class="view">
                <!-- View selection -->
                <div id="analytics-app">
                    <div class="analytics-top">
                        <div class="analytics-canvas-container">
                            <canvas id="analytics-canvas" width="128" height="128"></canvas>
                        </div>
                        
                        <div id="chart"></div>
                    </div>

                    <div class="analytics-bottom">
                        <div class="analytics-acceleration">
                            <label>
                                <input type="checkbox" id="analytics-octree-toggle">
                                Use octree acceleration
                            </label>
                            <label>
                               <input type="checkbox" id="analytics-bvh-toggle">
                               Use BVH acceleration
                            </label>
                        </div>
                        <!-- made each option its own selection, to get a 2x2 grid -->
                        <div class="analytics-controls-grid">
                            <div>
                                <label for="analytics-algorithm">Select algorithm: </label>
                                <select name="selectedAlgo" id="analytics-algorithm">
                                    <option value="sphere-tracing">Sphere Tracing</option>
                                    <option value="fixed-step">Fixed Step</option>
                                    <option value="adaptive-step">Adaptive Step</option>
                                    <option value="adaptive-step-v2">Adaptive Step V2</option>
                                </select>
                            </div>

                            <div>
                                <label for="analytics-scene-select">Select scene: </label>
                                <select name="selectedScene" id="analytics-scene-select"></select>
                            </div>
                            <div>
                                <label for="analytics-shading-model">Shading model: </label>
                                <select name="selectedModel" id="analytics-shading-model">
                                    <option value="normal">Normal</option>
                                    <option value="phong">Phong</option>
                                    <option value="sdf-heatmap">SDF Heatmap</option>
                                    <option value="iteration-heatmap">Iteration Heatmap</option>
                                </select>
                            </div>
                            <div>
                                <label for="analytics-menu">Select metric: </label>
                                <select id="analytics-menu">
                                    <option value="avg-sdf">Average SDF Calls</option>
                                    <option value="max-sdf">Max SDF Calls</option>
                                    <option value="frame-length">Frame Length</option>
                                    <option value="avg-iters">Average Iterations</option>
                                </select>
                            </div>
                        </div>

                        <div class="analytics-sliders">
                            <div id="analytics-overshoot-slider-container" style="display: none;">
                                <label for="analytics-overshoot-slider">Overshoot Factor: <span id="analytics-overshoot-value">1.2</span></label>
                                <input type="range" id="analytics-overshoot-slider" min="1.0" max="2.0" step="0.05" value="1.2">
                            </div>

                            <div id="analytics-stepsize-slider-container" style="display: none;">
                                <label for="analytics-stepsize-slider">Step Size: <span id="analytics-stepsize-value">0.1</span></label>
                                <input type="range" id="analytics-stepsize-slider" min="0.01" max="0.5" step="0.01" value="0.1">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- /#views -->
    </div> <!-- /.page-wrapper -->

</body>
</html>
